## Function-level Vulenrability Dataset

Hi there, welcome to this page!

This page contains the code and data used in a paper which is under review. When the review process is completed, we will upload all the data used.

### Requirements:

 * [Tensorflow-gpu-1.12.0](https://www.tensorflow.org/)
 * [Keras-2.2.4](https://github.com/fchollet/keras/tree/master/keras)
 * Python >= 3.5
 * [CodeSensor](https://github.com/fabsx00/codesensor)

The dependencies can be installed using [Anaconda](https://www.anaconda.com/download/). For example:

```bash
$ bash Anaconda3-2018.12-Linux-x86_64.sh
```

### Instructions:

The "Data" folder contains the source code of vulnerable functions and non-vulnerable ones stored in a Zip file containing the 9 projects used in the experiments. After unzipping the files, one will find that the source code of each vulnerable function was named with its CVE ID. For the non-vulnerable functions, they were named with "{filename}_{functionname}.c" format. 

This folder also contains the Vulnerabilities_info.xlsx file which details information of the collected function-level vulnerabilities. These vulnerabilities are from 9 open-source projects. The vulnerability information was collected from [National Vulnerability Database(NVD)](https://nvd.nist.gov/) until the end of 2018.

The table shown below is the website of 9 open-source projects.

    ------------------------------------------------------------------------
      Open-source projects  |         Web page
    ------------------------------------------------------------------------
          Asterisk          |    https://www.asterisk.org/
          FFmpeg            |    https://ffmpeg.org/
          HTTPD             |    https://httpd.apache.org
          LibPNG            |    https://www.libpng.org/pub/png/libpng.html
          LibTIFF           |    https://www.libtiff.org/
          OpenSSL           |    https://www.openssl.org/
          Pidgin            |    https://pidgin.im/
          VLC Media Player  |    https://www.videolan.org/vlc/index.html
          Xen               |    https://xenproject.org/
    ------------------------------------------------------------------------

The following graphs show the statistics of vulnerabilities which the 9 open-source projects collected.

<div align=center><img width="500" height="400" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/The%20number%20of%20vulnerabilities.jpg" alt="Tree Graph of Category"/></div>
Fig.1 shows the number of vulnerabilities for each open-source project.

<div align=center><img width="400" height="300" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Vulnerability%20Annual%20Statistics.jpg" alt="Tree Graph of Category"/></div>
Fig.2 shows the distribution of vulnerability data which we labeled in each year.

<div align=center><img width="400" height="300" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Trend.jpg" alt="Tree Graph of Category"/></div>
Fig.3 shows the trend of the labeled vulnerabilities.

<div align=center><img width="400" height="300" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Vulnerability%20category%20treemap.jpg" alt="Tree Graph of Category"/></div>
Fig.4 shows the distribution of labeled vulnerability category.

<div align=center> <img width="400" height="300" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Severity%20Histogram.jpg" alt="Tree Graph of Category"/></div>
Fig.5 shows the number of labeled vulnerability severity.

The "Code" folder contains two folders. One is Mix\_projects and the other is Cross\_projects. 
The Mix\_projects folder contains the Python code samples which implements a mix-project detection for the purpose of evaluating network performance.
The Cross\_projects folder contains the Python code samples which use 8 projects for training a vulnerability detector for detection on the remaining project. 

1. LoadCFilesAsText.py is to split the C files into textual sequences. A non-vulnerability function file is labeled as 0, and a vulnerability function file is labeled as 1. The result is saved as a .pkl file.
2. Embedding.py is to convert code tokens to vector representations. We use word2vec model for generating representations. The outputs are saved in a .txt and .pkl file.
3. DNN\_embedding\_model\_GPU.py, GRU\_model\_GPU.py, LSTM\_model\_GPU.py, BiGRU\_model\_GPU.py, BiLSTM\_model\_GPU.py, Text\_CNN\_model\_GPU.py are all the neural models selected for evaluation.
4. Train\_BiGRU.py file contains the code for implementing training a Bi-GRU network.

### Training and Results:

The following graphs are the loss function curve.Fig.6 is based on GRU model.Fig.7 is based on Bi-GRU model.
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td align="center"><img src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/GRU_Epoch_loss.jpg" width="300" height="300" /> </td>
    <td align="center"><img src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/BiGRU_Epoch_loss.jpg" width="300" height="300" /></td>
  </tr>
  <tr>
    <td align="center">Fig. 6: The Loss Function Curve Based on GRU model</td>
    <td align="center">Fig. 7: The Loss Function Curve Based on Bi-GRU model</td>
  </tr>
</table>

The following graph are the precision and recall compare all projects which we labeled.
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td align="center"><img src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Precision_compare_all_projects.jpg" width="400" height="400" /> </td>
    <td align="center"><img src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Recall_compare_all_projects.jpg" width="400" height="400" /></td>
  </tr>
  <tr>
    <td align="center">Fig. 8: Precision Compare All Projects</td>
    <td align="center">Fig. 9: Recall Compare All Projects</td>
  </tr>
</table>

### Contact:

You are welcomed to improve our code as well as our method. Please kindly cite our paper if you use the code/data in your work. For acquiring more data or inquiries, please contact: junzhang@swin.edu.au.

Thanks!
