## Function-level Vulenrability Dataset

Hi there, welcome to this page!

This page contains the code and data used in a paper which is under review. When the review process is completed, we will upload all the data used.

### Requirements:

 * [Tensorflow-gpu-1.12.0](https://www.tensorflow.org/)
 * [Keras-2.2.4](https://github.com/fchollet/keras/tree/master/keras)
 * Python >= 3.5
 * [CodeSensor](https://github.com/fabsx00/codesensor)

The dependencies can be installed using [Anaconda](https://www.anaconda.com/download/). For example:

```bash
$ bash Anaconda3-2018.12-Linux-x86_64.sh
```

### Instructions:

The "Data" folder contains the source code of vulnerable functions and non-vulnerable ones stored in a Zip file containing the 9 projects used in the experiments. After unzipping the files, one will find that the source code of each vulnerable function was named with its CVE ID. For the non-vulnerable functions, they were named with "{filename}_{functionname}.c" format. 

This folder also contains the Vulnerabilities_info.xlsx file which details information of the collected function-level vulnerabilities. These vulnerabilities are from 9 open-source projects. The vulnerability information was collected from [National Vulnerability Database(NVD)](https://nvd.nist.gov/) until the end of 2018.

The table shown below is the website of 9 open-source projects.

    ------------------------------------------------------------------------
      Open-source projects  |         Web page
    ------------------------------------------------------------------------
          Asterisk          |    https://www.asterisk.org/
          FFmpeg            |    https://ffmpeg.org/
          HTTPD             |    https://httpd.apache.org
          LibPNG            |    https://www.libpng.org/pub/png/libpng.html
          LibTIFF           |    https://www.libtiff.org/
          OpenSSL           |    https://www.openssl.org/
          Pidgin            |    https://pidgin.im/
          VLC Media Player  |    https://www.videolan.org/vlc/index.html
          Xen               |    https://xenproject.org/
    ------------------------------------------------------------------------

The following graphs show the statistics of vulnerabilities which the 9 open-source projects collected.
The graph shown below is the vulnerability category treemap.
<div align=center><img width="400" height="300" src="https://github.com/Seahymn2019/Function-level-Vulnerability-Dataset/blob/master/Graph/Tree%20Graph%20of%20Category.jpg" alt="Tree Graph of Category"/></div>

The "Code" folder contains two folders. One is Mix\_projects and the other is Cross\_projects. 
The Mix\_projects folder contains the Python code samples which implements a mix-project detection for the purpose of evaluating network performance.
The Cross\_projects folder contains the Python code samples which use 8 projects for training a vulnerability detector for detection on the remaining project. 

1. LoadCFilesAsText.py is to split the C files into textual sequences. A non-vulnerability function file is labeled as 0, and a vulnerability function file is labeled as 1. The result is saved as a .pkl file.
2. Embedding.py is to convert code tokens to vector representations. We use word2vec model for generating representations. The outputs are saved in a .txt and .pkl file.
3. DNN\_embedding\_model\_GPU.py, GRU\_model\_GPU.py, LSTM\_model\_GPU.py, BiGRU\_model\_GPU.py, BiLSTM\_model\_GPU.py, Text\_CNN\_model\_GPU.py are all the neural models selected for evaluation.
4. Train\_BiGRU.py file contains the code for implementing training a Bi-GRU network.

### Contact:

You are welcomed to improve our code as well as our method. Please kindly cite our paper if you use the code/data in your work. For acquiring more data or inquiries, please contact: junzhang@swin.edu.au.

Thanks!
